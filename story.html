<!doctype html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Histuri.com â€” Ù…Ù‚Ø§Ù„Ù‡</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header class="header">
    <div class="brand">
      <button id="openDrawer3" class="hamburger" aria-label="menu">â˜°</button>
      <div class="brand-text">
        <h1 class="site-title">Histuri.com âœ¨</h1>
        <div class="muted">Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ù…Ù‚Ø§Ù„Ù‡</div>
      </div>
    </div>
    <nav class="top-links">
      <a href="index.html">Ù…Ù‚Ø§Ù„Ø§Øª</a>
      <a href="stories.html">Ø¯Ø§Ø³ØªØ§Ù†â€ŒÙ‡Ø§</a>
      <a href="about.html">Ø¯Ø±Ø¨Ø§Ø±Ù‡</a>
    </nav>
  </header>

  <div id="backdrop3" class="backdrop"></div>
  <aside id="drawer3" class="drawer" aria-hidden="true" role="dialog">
    <div class="drawer-head">
      <div class="drawer-title">Ù…Ù†Ùˆ</div>
      <button id="closeDrawer3" class="close-btn" aria-label="close">âœ•</button>
    </div>
    <nav class="drawer-nav">
      <a href="index.html" class="drawer-link">ğŸ  Ø®Ø§Ù†Ù‡</a>
      <a href="stories.html" class="drawer-link">ğŸ“š Ø¯Ø§Ø³ØªØ§Ù†â€ŒÙ‡Ø§</a>
      <a href="about.html" class="drawer-link">â„¹ï¸ Ø¯Ø±Ø¨Ø§Ø±Ù‡</a>
    </nav>
  </aside>

  <main class="container">
    <div id="postArea"></div>
  </main>

  <footer class="site-footer">
    <div>Ø§ÛŒÙ† Ø³Ø§ÛŒØª ØªÙˆØ³Ø· Ø´Ø±Ú©Øª <strong>NIGHTNET</strong> Ø³Ø§Ø®ØªÙ‡ Ø´Ø¯Ù‡ â€” Â© Histuri.com</div>
  </footer>

  <script src="script.js"></script>
  <script>

    /* ------------------ ØªØ§Ø¨Ø¹ Ø­Ø°Ù Ù…Ù‚Ø§Ù„Ù‡ ------------------ */
    function deleteArticle(id){
      if(!confirm("Ø¢ÛŒØ§ Ù…Ø·Ù…Ø¦Ù† Ù‡Ø³ØªÛŒØ¯ Ú©Ù‡ Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡ÛŒØ¯ Ø§ÛŒÙ† Ù…Ù‚Ø§Ù„Ù‡ Ø±Ø§ Ø­Ø°Ù Ú©Ù†ÛŒØ¯ØŸ")) return;
      const raw = localStorage.getItem('histuri_articles');
      const arr = raw ? JSON.parse(raw) : [];
      arr.splice(id, 1);
      localStorage.setItem('histuri_articles', JSON.stringify(arr));
      alert("Ù…Ù‚Ø§Ù„Ù‡ Ø­Ø°Ù Ø´Ø¯.");
      location.href = "index.html";
    }

    (function(){
      initDrawer();

      const qs = new URLSearchParams(location.search);
      const id = qs.get('id');

      const raw = localStorage.getItem('histuri_articles');
      const arr = raw ? JSON.parse(raw) : [];
      const area = document.getElementById('postArea');

      if(!id || !arr[id]){
        area.innerHTML = `<div class="card">Ù…Ø·Ù„Ø¨ ÛŒØ§ÙØª Ù†Ø´Ø¯. <a href="index.html" class="btn ghost small">Ø¨Ø§Ø²Ú¯Ø´Øª</a></div>`;
        return;
      }

      const a = arr[id];

      /* Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ù…Ø¯ÛŒØ±ÛŒØªØŒ Ø¨Ø¯ÙˆÙ† ØªØºÛŒÛŒØ± Ú©Ø¯ Ù‚Ø¨Ù„ÛŒ */
      const admin = localStorage.getItem("histuri_admin_ok") === "1";
      let adminBtns = "";

      if(admin){
        adminBtns = `
          <div style="display:flex; gap:10px; margin-top:12px; justify-content:flex-end">
            <a class="btn small" href="edit.html?id=${id}">âœï¸ ÙˆÛŒØ±Ø§ÛŒØ´</a>
            <button class="btn small danger" onclick="deleteArticle(${id})">ğŸ—‘ Ø­Ø°Ù</button>
          </div>
        `;
      }

      area.innerHTML = `
        <article class="card post-card">
          ${a.thumbnail ? `<img src="${a.thumbnail}" class="article-thumb" alt="${escapeHtml(a.title)}">` : ''}
          <h2>${escapeHtml(a.title)}</h2>
          <div class="muted small">Ø¯Ø³ØªÙ‡: ${escapeHtml(a.category||'Ø¹Ù…ÙˆÙ…ÛŒ')}</div>
          <div class="content" style="margin-top:12px">${a.content || ''}</div>

          ${adminBtns}

          <div style="display:flex;justify-content:flex-end;margin-top:12px">
            <a class="btn ghost small" href="index.html">Ø¨Ø§Ø²Ú¯Ø´Øª</a>
          </div>
        </article>
      `;
    })();
  </script>
</body>
</html>
